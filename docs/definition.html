<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Functional Data: Definition, Representation and Manipulation | Functional Data Analysis using fda.usc and fda.clust packages</title>
  <meta name="description" content="Functional Data Analysis, Regression, Classification and Clustering using fda.usc and fda.clust packages" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Functional Data: Definition, Representation and Manipulation | Functional Data Analysis using fda.usc and fda.clust packages" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Functional Data Analysis, Regression, Classification and Clustering using fda.usc and fda.clust packages" />
  <meta name="github-repo" content="moviedo5/bookdown_fda_clust" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Functional Data: Definition, Representation and Manipulation | Functional Data Analysis using fda.usc and fda.clust packages" />
  
  <meta name="twitter:description" content="Functional Data Analysis, Regression, Classification and Clustering using fda.usc and fda.clust packages" />
  

<meta name="author" content="Manuel Oviedo de la Fuente (Universidade of A Coruña, CITIC, MODES RG) and Manuel Febrero-Bande (Universidade de Santaigo de Compostela, MODESTYA RG)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Escritura de libros con bookdown</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#cran-task-view"><i class="fa fa-check"></i>CRAN Task View</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#functional-data-analysis-in-r"><i class="fa fa-check"></i>Functional Data Analysis in R</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i>Installation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#quick-start"><i class="fa fa-check"></i>Quick Start</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="definition.html"><a href="definition.html"><i class="fa fa-check"></i><b>1</b> Functional Data: Definition, Representation and Manipulation</a>
<ul>
<li class="chapter" data-level="1.1" data-path="definition.html"><a href="definition.html#some-definitions-of-functional-data"><i class="fa fa-check"></i><b>1.1</b> Some definitions of Functional Data</a></li>
<li class="chapter" data-level="1.2" data-path="definition.html"><a href="definition.html#in-fda.usc-the-data-are-curves"><i class="fa fa-check"></i><b>1.2</b> In fda.usc: ``The data are curves’’</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="definition.html"><a href="definition.html#definition-of-fdata-class-in-r"><i class="fa fa-check"></i><b>1.2.1</b> Definition of –fdata– class in R</a></li>
<li class="chapter" data-level="1.2.2" data-path="definition.html"><a href="definition.html#some-utilities-of-fda.usc-package"><i class="fa fa-check"></i><b>1.2.2</b> Some utilities of fda.usc package</a></li>
<li class="chapter" data-level="1.2.3" data-path="definition.html"><a href="definition.html#definition-of-ldata-class-in-r"><i class="fa fa-check"></i><b>1.2.3</b> Definition of –ldata– class in R</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="definition.html"><a href="definition.html#resume-by-smoothing"><i class="fa fa-check"></i><b>1.3</b> Resume by smoothing</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="definition.html"><a href="definition.html#derivatives"><i class="fa fa-check"></i><b>1.3.1</b> Derivatives</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="definition.html"><a href="definition.html#correlation-distances-szekely2007"><i class="fa fa-check"></i><b>1.4</b> Correlation Distances <span class="citation">(G. J. Székely, Rizzo, and Bakirov 2007)</span></a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="definition.html"><a href="definition.html#depth-for-functional-data"><i class="fa fa-check"></i><b>1.4.1</b> Depth for functional data</a></li>
<li class="chapter" data-level="1.4.2" data-path="definition.html"><a href="definition.html#depth-and-distances-for-multivariate-functional-data-cuesta2017hbox"><i class="fa fa-check"></i><b>1.4.2</b> Depth (and distances) for multivariate functional data <span class="citation">(J. A. Cuesta-Albertos, Febrero-Bande, and Oviedo de la Fuente 2017)</span></a></li>
<li class="chapter" data-level="1.4.3" data-path="definition.html"><a href="definition.html#outliers-detection"><i class="fa fa-check"></i><b>1.4.3</b> Outliers detection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="definition.html"><a href="definition.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>2</b> Functional Regression Model</a>
<ul>
<li class="chapter" data-level="2.1" data-path="regression.html"><a href="regression.html#functional-linear-model-flr-with-basis-representation"><i class="fa fa-check"></i><b>2.1</b> Functional linear model (FLR) with basis representation</a></li>
<li class="chapter" data-level="2.2" data-path="regression.html"><a href="regression.html#flm-with-functional-and-non-functional-covariates"><i class="fa fa-check"></i><b>2.2</b> FLM with functional and non functional covariates</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="regression.html"><a href="regression.html#predict-method-for-functional-regression-model"><i class="fa fa-check"></i><b>2.2.1</b> Predict method for functional regression model</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="regression.html"><a href="regression.html#other-procedures"><i class="fa fa-check"></i><b>2.3</b> Other procedures</a></li>
<li class="chapter" data-level="2.4" data-path="regression.html"><a href="regression.html#non-linear-model-fv2006"><i class="fa fa-check"></i><b>2.4</b> Non Linear Model <span class="citation">(Frédéric Ferraty and Vieu 2006)</span></a></li>
<li class="chapter" data-level="2.5" data-path="regression.html"><a href="regression.html#semi-linear-model-aneiros2005"><i class="fa fa-check"></i><b>2.5</b> Semi Linear Model <span class="citation">(Aneiros-Pérez and Vieu 2006)</span></a></li>
<li class="chapter" data-level="2.6" data-path="regression.html"><a href="regression.html#generalized-linear-models-muller2005generalized"><i class="fa fa-check"></i><b>2.6</b> Generalized Linear Models <span class="citation">(Müller and Stadtmüller 2005)</span></a></li>
<li class="chapter" data-level="2.7" data-path="regression.html"><a href="regression.html#generalized-functional-additive-model"><i class="fa fa-check"></i><b>2.7</b> Generalized Functional Additive Model</a></li>
<li class="chapter" data-level="2.8" data-path="regression.html"><a href="regression.html#functional-gls-model"><i class="fa fa-check"></i><b>2.8</b> Functional GLS model</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="regression.html"><a href="regression.html#dependent-data-example"><i class="fa fa-check"></i><b>2.8.1</b> Dependent data example,</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="regression.html"><a href="regression.html#functional-response-model"><i class="fa fa-check"></i><b>2.9</b> Functional Response Model</a></li>
<li class="chapter" data-level="2.10" data-path="regression.html"><a href="regression.html#other-models"><i class="fa fa-check"></i><b>2.10</b> Other Models:</a></li>
<li class="chapter" data-level="" data-path="regression.html"><a href="regression.html#references-1"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functional-supervised-classification.html"><a href="functional-supervised-classification.html"><i class="fa fa-check"></i><b>3</b> Functional Supervised Classification</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functional-supervised-classification.html"><a href="functional-supervised-classification.html#logistic-regression-model-glm-classif.glm"><i class="fa fa-check"></i><b>3.1</b> Logistic Regression Model (GLM): <code>classif.glm</code></a></li>
<li class="chapter" data-level="3.2" data-path="functional-supervised-classification.html"><a href="functional-supervised-classification.html#generalized-additive-models-gam-classif.gsam-and-classif.gkam"><i class="fa fa-check"></i><b>3.2</b> Generalized Additive Models (GAM): <code>classif.gsam</code> and <code>classif.gkam</code></a></li>
<li class="chapter" data-level="3.3" data-path="functional-supervised-classification.html"><a href="functional-supervised-classification.html#nonparametric-classification-methods-classif.knn-and-classif.np-ferraty2003"><i class="fa fa-check"></i><b>3.3</b> Nonparametric classification methods: <code>classif.knn</code> and <code>classif.np</code> <span class="citation">(Frédéric Ferraty and Vieu 2003)</span></a></li>
<li class="chapter" data-level="3.4" data-path="functional-supervised-classification.html"><a href="functional-supervised-classification.html#maximum-depth-classif.depth-li2012"><i class="fa fa-check"></i><b>3.4</b> Maximum depth: <code>classif.depth</code> <span class="citation">(Li, Cuesta-Albertos, and Liu 2012)</span></a></li>
<li class="chapter" data-level="3.5" data-path="functional-supervised-classification.html"><a href="functional-supervised-classification.html#the-ddgclassifier-classif.dd-cuesta2017hbox"><i class="fa fa-check"></i><b>3.5</b> The DD<span class="math inline">\(^G\)</span>–classifier <code>classif.DD</code> <span class="citation">(J. A. Cuesta-Albertos, Febrero-Bande, and Oviedo de la Fuente 2017)</span></a></li>
<li class="chapter" data-level="3.6" data-path="functional-supervised-classification.html"><a href="functional-supervised-classification.html#classifiers-adapted-from-multivariate-framework"><i class="fa fa-check"></i><b>3.6</b> Classifiers adapted from Multivariate Framework</a></li>
<li class="chapter" data-level="" data-path="functional-supervised-classification.html"><a href="functional-supervised-classification.html#references-2"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="variable-selection.html"><a href="variable-selection.html"><i class="fa fa-check"></i><b>4</b> Variable Selection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="variable-selection.html"><a href="variable-selection.html#functiondal-regression-with-points-of-impact"><i class="fa fa-check"></i><b>4.1</b> Functiondal regression with points of impact</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="variable-selection.html"><a href="variable-selection.html#state-of-art"><i class="fa fa-check"></i><b>4.1.1</b> State of Art</a></li>
<li class="chapter" data-level="4.1.2" data-path="variable-selection.html"><a href="variable-selection.html#local-maxima-distance-correlation-approach-lmdc-ordonez2018"><i class="fa fa-check"></i><b>4.1.2</b> Local maxima distance correlation approach (LMDC), <span class="citation">(Ordóñez et al. 2018)</span></a></li>
<li class="chapter" data-level="4.1.3" data-path="variable-selection.html"><a href="variable-selection.html#lmdc-algorithm-lmdc.select-function"><i class="fa fa-check"></i><b>4.1.3</b> LMDC Algorithm: <code>LMDC.select()</code> function</a></li>
<li class="chapter" data-level="4.1.4" data-path="variable-selection.html"><a href="variable-selection.html#lmdc-algorithm-lmdc.regre-function"><i class="fa fa-check"></i><b>4.1.4</b> LMDC Algorithm: <code>LMDC.regre()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="variable-selection.html"><a href="variable-selection.html#variable-selection-in-functional-regression"><i class="fa fa-check"></i><b>4.2</b> Variable selection in functional regression</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="variable-selection.html"><a href="variable-selection.html#state-of-art-1"><i class="fa fa-check"></i><b>4.2.1</b> State of Art</a></li>
<li class="chapter" data-level="4.2.2" data-path="variable-selection.html"><a href="variable-selection.html#algorithm"><i class="fa fa-check"></i><b>4.2.2</b> Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="variable-selection.html"><a href="variable-selection.html#binary-classification-example"><i class="fa fa-check"></i><b>4.3</b> Binary classification example</a></li>
<li class="chapter" data-level="4.4" data-path="variable-selection.html"><a href="variable-selection.html#hyperspectral-images-example"><i class="fa fa-check"></i><b>4.4</b> Hyperspectral images example</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="variable-selection.html"><a href="variable-selection.html#hyperspectral-data-set-pavia-university"><i class="fa fa-check"></i><b>4.4.1</b> Hyperspectral Data set: Pavia University</a></li>
<li class="chapter" data-level="4.4.2" data-path="variable-selection.html"><a href="variable-selection.html#hyperspectral-images"><i class="fa fa-check"></i><b>4.4.2</b> Hyperspectral images</a></li>
<li class="chapter" data-level="4.4.3" data-path="variable-selection.html"><a href="variable-selection.html#pravia-univ.-results"><i class="fa fa-check"></i><b>4.4.3</b> Pravia Univ. Results</a></li>
<li class="chapter" data-level="4.4.4" data-path="variable-selection.html"><a href="variable-selection.html#functional-data-example"><i class="fa fa-check"></i><b>4.4.4</b> Functional data example</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="variable-selection.html"><a href="variable-selection.html#optimum-multiscale-selection-in-3d-point-cloud-classification-oviedo2021distance"><i class="fa fa-check"></i><b>4.5</b> Optimum Multiscale Selection in 3D Point Cloud Classification <span class="citation">(Oviedo-de la Fuente et al. 2021)</span></a></li>
<li class="chapter" data-level="4.6" data-path="variable-selection.html"><a href="variable-selection.html#model-comparison"><i class="fa fa-check"></i><b>4.6</b> Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="conclusions-and-future-work.html"><a href="conclusions-and-future-work.html"><i class="fa fa-check"></i><b>5</b> Conclusions and future work</a>
<ul>
<li class="chapter" data-level="5.1" data-path="conclusions-and-future-work.html"><a href="conclusions-and-future-work.html#conclusions"><i class="fa fa-check"></i><b>5.1</b> Conclusions</a></li>
<li class="chapter" data-level="5.2" data-path="conclusions-and-future-work.html"><a href="conclusions-and-future-work.html#code-r-scripts-and-notebooks"><i class="fa fa-check"></i><b>5.2</b> Code: R scripts and notebooks</a></li>
<li class="chapter" data-level="5.3" data-path="conclusions-and-future-work.html"><a href="conclusions-and-future-work.html#future-work"><i class="fa fa-check"></i><b>5.3</b> Future work</a></li>
<li class="chapter" data-level="5.4" data-path="conclusions-and-future-work.html"><a href="conclusions-and-future-work.html#future-work-wells-riley-equation"><i class="fa fa-check"></i><b>5.4</b> Future work: Wells-Riley equation</a></li>
<li class="chapter" data-level="" data-path="conclusions-and-future-work.html"><a href="conclusions-and-future-work.html#references-3"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functional-clustering.html"><a href="functional-clustering.html"><i class="fa fa-check"></i><b>6</b> Functional Clustering</a>
<ul>
<li class="chapter" data-level="6.1" data-path="functional-clustering.html"><a href="functional-clustering.html#k-means-clustering-for-functional-data-hartigan1979algorithm"><i class="fa fa-check"></i><b>6.1</b> K-Means Clustering for functional data, <span class="citation">Hartigan and Wong (1979)</span></a></li>
<li class="chapter" data-level="" data-path="functional-clustering.html"><a href="functional-clustering.html#references-4"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="functional-clustering.html"><a href="functional-clustering.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Functional Data Analysis using fda.usc and fda.clust packages</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="definition" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> Functional Data: Definition, Representation and Manipulation<a href="definition.html#definition" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="some-definitions-of-functional-data" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Some definitions of Functional Data<a href="definition.html#some-definitions-of-functional-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Functional data analysis is a branch of statistics that analyzes data providing information about curves, surfaces or anything else varying over a continuum. The continuum is often time, but may also be spatial location, wavelength, probability, etc.</p>
<p>Functional data analysis is a branch of statistics concerned with analysing data in the form of functions.</p>
<ul>
<li><p>Definition 1: A random variable <span class="math inline">\(\mathcal{X}\)</span> is called a functional variable if it takes values in a functional space <span class="math inline">\(\mathcal{E}\)</span> –complete normed (or seminormed) space–, <span class="citation">(<a href="#ref-FV2006">Frédéric Ferraty and Vieu 2006</a>)</span></p></li>
<li><p>Definition 2: A functional dataset <span class="math inline">\(\{\mathcal{X}_1,\ldots,\mathcal{X}_n\}\)</span> is the observation of <em>n</em> functional variables <span class="math inline">\(\mathcal{X}_1,\ldots,\mathcal{X}_n\)</span> identically distributed as <span class="math inline">\(\mathcal{X}\)</span>, <span class="citation">(<a href="#ref-FV2006">Frédéric Ferraty and Vieu 2006</a>)</span>.</p></li>
</ul>
<p>A research stream focuses on the computational treatment that is used to working with functional data as an extension of multivariate data. Thus, the following definition of functional data proposed by <span class="citation">(<a href="#ref-mu2008functional">Muller et al. 2008</a>)</span> is also common in practice.</p>
<ul>
<li>Definition 3. Functional data is multivariate data with an ordering on the dimensions, so that <span class="math inline">\(a=t_1&lt;t_2,\ldots,t_{m-1}&lt; b=t_m\)</span>.</li>
</ul>
</div>
<div id="in-fda.usc-the-data-are-curves" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> In fda.usc: ``The data are curves’’<a href="definition.html#in-fda.usc-the-data-are-curves" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math inline">\(X_i(t)\)</span> represents the mean temperature (averaged over 1980-2009 years) at the <em>i</em>th weather station in Spain, and at time time <span class="math inline">\(t\)</span> during the year.</p>
<p>Temperature curves (right) located in Spanish airports (left),
<img src="bookdown_intro_files/figure-html/unnamed-chunk-8-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>But what code has been used to obtain the graph?</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="definition.html#cb3-1" tabindex="-1"></a><span class="fu">data</span>(aemet)</span>
<span id="cb3-2"><a href="definition.html#cb3-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb3-3"><a href="definition.html#cb3-3" tabindex="-1"></a>CanaryIslands <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(aemet<span class="sc">$</span>df<span class="sc">$</span>latitude <span class="sc">&lt;</span> <span class="dv">31</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb3-4"><a href="definition.html#cb3-4" tabindex="-1"></a><span class="fu">plot</span>(aemet<span class="sc">$</span>df[,<span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>,<span class="st">&quot;latitude&quot;</span>)], <span class="at">col =</span> CanaryIslands, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb3-5"><a href="definition.html#cb3-5" tabindex="-1"></a><span class="fu">plot</span>(temp, <span class="at">col =</span> CanaryIslands, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<div id="definition-of-fdata-class-in-r" class="section level3 hasAnchor" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Definition of –fdata– class in R<a href="definition.html#definition-of-fdata-class-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Definition of fdata class object: An object called <code>fdata</code> as a list of the following components:</p>
<ul>
<li><code>data</code>: typically a matrix of <em>(n x m)</em> dimension which contains a set of <em>n</em> curves discretized in <em>m</em> points or <code>argvals</code>.</li>
<li><code>argvals</code>: locations of the discretization points, by default: <span class="math inline">\({{t}_1=1,\ldots,{t}_m=m}\}\)</span>.</li>
<li><code>rangeval</code>: rangeval of discretization points.</li>
<li><code>names</code>: (optional) list with three components: <code>main</code>, an overall title, <code>xlab</code>, a title for the x axis and <code>ylab</code>, a title for the y axis.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="definition.html#cb4-1" tabindex="-1"></a><span class="fu">lapply</span>(aemet,class)</span>
<span id="cb4-2"><a href="definition.html#cb4-2" tabindex="-1"></a><span class="fu">names</span>(aemet<span class="sc">$</span>df)</span>
<span id="cb4-3"><a href="definition.html#cb4-3" tabindex="-1"></a><span class="fu">lapply</span>(aemet<span class="sc">$</span>temp,class)</span>
<span id="cb4-4"><a href="definition.html#cb4-4" tabindex="-1"></a>temp <span class="ot">&lt;-</span> aemet<span class="sc">$</span>temp</span>
<span id="cb4-5"><a href="definition.html#cb4-5" tabindex="-1"></a><span class="fu">names</span>(temp)</span>
<span id="cb4-6"><a href="definition.html#cb4-6" tabindex="-1"></a><span class="fu">dim</span>(temp)</span>
<span id="cb4-7"><a href="definition.html#cb4-7" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">argvals</span>(temp))</span>
<span id="cb4-8"><a href="definition.html#cb4-8" tabindex="-1"></a><span class="fu">rangeval</span>(temp)</span>
<span id="cb4-9"><a href="definition.html#cb4-9" tabindex="-1"></a>temp<span class="sc">$</span>names</span></code></pre></div>
</div>
<div id="some-utilities-of-fda.usc-package" class="section level3 hasAnchor" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Some utilities of fda.usc package<a href="definition.html#some-utilities-of-fda.usc-package" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Basic operations for fdata class objects:</li>
</ol>
<ul>
<li>Group Math: <code>abs</code>, <code>sqrt</code>, <code>floor</code>, <code>ceiling,</code>semimetric.basis()<code>,</code>trunc<code>,</code>round<code>,</code>signif<code>,</code>exp<code>,</code>log<code>,</code>cos<code>,</code>sin<code>,</code>tan`.</li>
<li>Other operations: <code>[]</code>, <code>is.fdata()</code>, <code>c()</code>, <code>dim()</code>, <code>ncol()</code>, <code>nrow()</code>.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="definition.html#cb5-1" tabindex="-1"></a><span class="fu">is.fdata</span>(aemet<span class="sc">$</span>temp)</span>
<span id="cb5-2"><a href="definition.html#cb5-2" tabindex="-1"></a><span class="fu">is.fdata</span>(aemet<span class="sc">$</span>df)</span>
<span id="cb5-3"><a href="definition.html#cb5-3" tabindex="-1"></a><span class="fu">dim</span>(aemet<span class="sc">$</span>df)</span>
<span id="cb5-4"><a href="definition.html#cb5-4" tabindex="-1"></a><span class="fu">dim</span>(aemet<span class="sc">$</span>temp)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Convert the class</li>
</ol>
<ul>
<li>The class <strong>fdata</strong> only uses the evaluations at the discretization points.</li>
<li>The <code>fdata2fd()</code> converts <strong>fdata</strong> object to <strong>fd</strong> object (using the basis representation).</li>
<li>Inversely, the <code>fdata()</code> converts object of class: <strong>fd</strong>, <strong>fds</strong>, <strong>fts</strong>, <strong>sfts</strong>, <strong>vector</strong>, <strong>matrix</strong>, <strong>data.frame</strong> to an object of class <strong>fdata</strong>.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="definition.html#cb6-1" tabindex="-1"></a>temp.fd<span class="ot">=</span><span class="fu">fdata2fd</span>(temp,<span class="at">type.basis=</span><span class="st">&quot;fourier&quot;</span>,<span class="at">nbasis=</span><span class="dv">15</span>)</span>
<span id="cb6-2"><a href="definition.html#cb6-2" tabindex="-1"></a>temp.fdata<span class="ot">=</span><span class="fu">fdata</span>(temp.fd) <span class="co">#back to fdata</span></span>
<span id="cb6-3"><a href="definition.html#cb6-3" tabindex="-1"></a><span class="fu">class</span>(temp.fd)</span></code></pre></div>
<pre><code>## [1] &quot;fd&quot;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="definition.html#cb8-1" tabindex="-1"></a><span class="fu">class</span>(temp.fdata)</span></code></pre></div>
<pre><code>## [1] &quot;fdata&quot;</code></pre>
<ul>
<li><code>split.fdata()</code> and <code>unlist()</code>: A wrapper for the split and unlist function for fdata object</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="definition.html#cb10-1" tabindex="-1"></a><span class="co"># Canary Islands in red vs Iberian Peninsula in blue</span></span>
<span id="cb10-2"><a href="definition.html#cb10-2" tabindex="-1"></a>l1 <span class="ot">&lt;-</span> fda.usc<span class="sc">:::</span><span class="fu">split.fdata</span>(temp,CanaryIslands)</span>
<span id="cb10-3"><a href="definition.html#cb10-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb10-4"><a href="definition.html#cb10-4" tabindex="-1"></a><span class="fu">plot</span>(l1[[<span class="dv">1</span>]],<span class="at">col=</span><span class="dv">2</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>))</span>
<span id="cb10-5"><a href="definition.html#cb10-5" tabindex="-1"></a><span class="fu">plot</span>(l1[[<span class="dv">2</span>]],<span class="at">col=</span><span class="dv">4</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>))</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-13-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="definition.html#cb11-1" tabindex="-1"></a><span class="fu">dim</span>(l1[[<span class="dv">1</span>]]);<span class="fu">dim</span>(l1[[<span class="dv">2</span>]])</span></code></pre></div>
<pre><code>## [1]   9 365</code></pre>
<pre><code>## [1]  64 365</code></pre>
<ul>
<li>Group Ops: + -, *, /, ^, %%, %/%, &amp;, |, !, ==, !=, &lt;, &lt;=, &gt;=, &gt;.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="definition.html#cb14-1" tabindex="-1"></a>l1[[<span class="dv">1</span>]]<span class="sc">==</span>l1[[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<ul>
<li><code>order.fdata()</code> A wrapper for the order function. The funcional data is ordered w.r.t the sample order of the values of vector.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="definition.html#cb16-1" tabindex="-1"></a>temp2 <span class="ot">&lt;-</span> <span class="fu">order.fdata</span>(<span class="fu">order</span>(CanaryIslands),temp)</span></code></pre></div>
<ul>
<li>Generate random process of fdata class.</li>
</ul>
<p><code>rproc2fdata()</code> function generates Functional data from: Ornstein Uhlenbeck process, Brownian process, Gaussian process or Exponential variogram process.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="definition.html#cb17-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb17-2"><a href="definition.html#cb17-2" tabindex="-1"></a>lent <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb17-3"><a href="definition.html#cb17-3" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">len=</span>lent)</span>
<span id="cb17-4"><a href="definition.html#cb17-4" tabindex="-1"></a>xgen1 <span class="ot">&lt;-</span> <span class="fu">rproc2fdata</span>(<span class="dv">200</span>,<span class="at">t=</span>tt,<span class="at">sigma=</span><span class="st">&quot;OU&quot;</span>,<span class="at">par.list=</span><span class="fu">list</span>(<span class="st">&quot;scale&quot;</span><span class="ot">=</span><span class="dv">1</span>))</span>
<span id="cb17-5"><a href="definition.html#cb17-5" tabindex="-1"></a><span class="fu">plot</span>(xgen1)</span>
<span id="cb17-6"><a href="definition.html#cb17-6" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>tt),tt)</span>
<span id="cb17-7"><a href="definition.html#cb17-7" tabindex="-1"></a>xgen2 <span class="ot">&lt;-</span> <span class="fu">rproc2fdata</span>(<span class="dv">200</span>,<span class="at">mu=</span>mu,<span class="at">sigma=</span><span class="st">&quot;OU&quot;</span>,<span class="at">par.list=</span><span class="fu">list</span>(<span class="st">&quot;scale&quot;</span><span class="ot">=</span><span class="dv">1</span>))</span>
<span id="cb17-8"><a href="definition.html#cb17-8" tabindex="-1"></a><span class="fu">plot</span>(xgen2)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-16-1.png" width="80%" style="display: block; margin: auto;" />
<!--
Other functons:
**gridfdata()**  generates *n* curves as lineal combination of the original curves *fdataobj* plus a functional trend *mu*.

**rcombfdata()** generates *n* random linear combinations of the *fdataobj* curves plus a functional trend *mu*. The coefficients of the combinations follows a normal distribution with zero mean and standard deviation *sdarg*.
--></p>
</div>
<div id="definition-of-ldata-class-in-r" class="section level3 hasAnchor" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Definition of –ldata– class in R<a href="definition.html#definition-of-ldata-class-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ldata is a list with two type of objects:</p>
<ul>
<li><code>df</code> is a data frame with the multivariate data with <em>n</em> rows.</li>
<li><code>...</code> objects of class <code>fdata</code> with <em>n</em> rows.</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="definition.html#cb18-1" tabindex="-1"></a>ldat <span class="ot">&lt;-</span> <span class="fu">ldata</span>(<span class="at">df=</span>aemet<span class="sc">$</span>df,<span class="at">temp=</span>aemet<span class="sc">$</span>temp, <span class="at">logprec=</span>aemet<span class="sc">$</span>logprec )</span>
<span id="cb18-2"><a href="definition.html#cb18-2" tabindex="-1"></a><span class="fu">plot</span>(ldat)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-17-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="resume-by-smoothing" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Resume by smoothing<a href="definition.html#resume-by-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If we supposed that our functional data <span class="math inline">\(Y(t)\)</span> is observed through the model <span class="math inline">\(Y(t_i)=X(t_i)+\varepsilon(t_i)\)</span>
where the residuals <span class="math inline">\(\varepsilon(t)\)</span> are independent with <span class="math inline">\(X(t)\)</span>.</p>
<p>We can to get back the original signal <span class="math inline">\(X(t)\)</span> using a linear smoother:
<span class="math display">\[\hat{X}(t_i)=\sum_{i=1}^{n} s_{i}(t_j)Y(t_i)  \Rightarrow \mathbf{\hat{X}}=\mathbf{S}\mathbf{Y} \]</span>
where <span class="math inline">\(s_{i}(t_j)\)</span> is the weight that the point <span class="math inline">\(t_j\)</span> gives to the point <span class="math inline">\(t_i\)</span>.</p>
<p>We use two methods to estimate the smoothing matrix <span class="math inline">\(S\)</span>.</p>
<ol style="list-style-type: decimal">
<li>Finite representation in a fixed basis <span class="citation">(<a href="#ref-Ramsay2005">Ramsay and Silverman 2005a</a>)</span>:</li>
</ol>
<p>Let <span class="math inline">\(X(t)\in \mathcal{L}_2\)</span>,
<span class="math display">\[ X(t)= \sum_{k\in\mathbb{N}}{c_k\phi_k(t)}\approx\sum_{k=1}^K c_k\phi_k(t)=c^{\top}\Phi\]</span></p>
<p>The smoothing matrix is given by: <span class="math inline">\(\mathbf{S}=\Phi(\Phi^{\top}W\Phi+\lambda R)^{-1}\Phi^{\top}W\)</span> where <span class="math inline">\(\lambda\)</span> is the penalty parameter.</p>
<p>Type of basis:</p>
<ul>
<li><p>Fourier: Design to represent periodic functions. Orthonormal</p></li>
<li><p>BSplines: Set of polynomials (of order m) defined in subintervals constructed in such a way that in the border of the subintervals the polynomials coincide (up to <span class="math inline">\(m - 2\)</span> derivative). Banded</p></li>
<li><p>Wavelets: Powerful especially when the grid is a power of 2. Orthonormal</p></li>
<li><p>Polynomials: Adjust a polynomial to the whole curve.</p></li>
</ul>
<p>Example: raw (left) and smoothed temperature curves with 111 (center) and 11 (right) elements of a B-spline base:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="definition.html#cb19-1" tabindex="-1"></a>bsp11 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(temp<span class="sc">$</span>rangeval,<span class="at">nbasis=</span><span class="dv">11</span>)</span>
<span id="cb19-2"><a href="definition.html#cb19-2" tabindex="-1"></a>bsp111 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(temp<span class="sc">$</span>rangeval,<span class="at">nbasis=</span><span class="dv">111</span>)</span>
<span id="cb19-3"><a href="definition.html#cb19-3" tabindex="-1"></a>S.bsp11 <span class="ot">&lt;-</span>  <span class="fu">S.basis</span>(temp<span class="sc">$</span>argvals, bsp11)</span>
<span id="cb19-4"><a href="definition.html#cb19-4" tabindex="-1"></a>S.bsp111 <span class="ot">&lt;-</span> <span class="fu">S.basis</span>(temp<span class="sc">$</span>argvals, bsp111)</span>
<span id="cb19-5"><a href="definition.html#cb19-5" tabindex="-1"></a>temp.bsp11 <span class="ot">&lt;-</span> temp.bsp111 <span class="ot">&lt;-</span> temp</span>
<span id="cb19-6"><a href="definition.html#cb19-6" tabindex="-1"></a>temp.bsp11<span class="sc">$</span>data <span class="ot">&lt;-</span> temp<span class="sc">$</span>data<span class="sc">%*%</span>S.bsp11</span>
<span id="cb19-7"><a href="definition.html#cb19-7" tabindex="-1"></a>temp.bsp111<span class="sc">$</span>data <span class="ot">&lt;-</span> temp<span class="sc">$</span>data<span class="sc">%*%</span>S.bsp111 </span>
<span id="cb19-8"><a href="definition.html#cb19-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb19-9"><a href="definition.html#cb19-9" tabindex="-1"></a><span class="fu">plot</span>(temp)</span>
<span id="cb19-10"><a href="definition.html#cb19-10" tabindex="-1"></a><span class="fu">plot</span>(temp.bsp111, <span class="at">main=</span><span class="st">&quot;111 Bspline basis elements&quot;</span>)</span>
<span id="cb19-11"><a href="definition.html#cb19-11" tabindex="-1"></a><span class="fu">plot</span>(temp.bsp11, <span class="at">main=</span><span class="st">&quot;11 Bspline basis elements&quot;</span>)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-18-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="definition.html#cb20-1" tabindex="-1"></a><span class="co"># Another way </span></span>
<span id="cb20-2"><a href="definition.html#cb20-2" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">optim.basis</span>(temp, <span class="at">type.CV=</span>CV.S)</span>
<span id="cb20-3"><a href="definition.html#cb20-3" tabindex="-1"></a><span class="fu">names</span>(out1)</span></code></pre></div>
<pre><code>##  [1] &quot;gcv&quot;          &quot;numbasis&quot;     &quot;lambda&quot;       &quot;fdataobj&quot;     &quot;fdata.est&quot;   
##  [6] &quot;gcv.opt&quot;      &quot;numbasis.opt&quot; &quot;lambda.opt&quot;   &quot;S.opt&quot;        &quot;base.opt&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="definition.html#cb22-1" tabindex="-1"></a>out1<span class="sc">$</span>numbasis.opt</span></code></pre></div>
<pre><code>## [1] 76</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Kernel Smoothing <span class="citation">(<a href="#ref-FV2006">Frédéric Ferraty and Vieu 2006</a>)</span></li>
</ol>
<p>The problem is to estimate the smoothing parameter or bandwidth <span class="math inline">\(\nu=h\)</span> that better represents the functional data using kernel smoothing.
Now,the nonparametric smoothing of functional data is given by the smoothing matrix <span class="math inline">\(S\)</span>:
<span class="math display">\[s_{ij}=\frac{1}{h}K\left(\frac{t_i-t_j}{h}\right)\]</span></p>
<p><span class="math display">\[S(h)=(s_j(t_i))=\frac{K\left(\frac{t_i-t_j}{h}\right)}{\sum_{k=1}^{\top}K\left(\frac{t_k-t_j}{h}\right)}\]</span>
where <span class="math inline">\(h\)</span> is the bandwidth and <span class="math inline">\(K()\)</span> the Kernel function.</p>
<p>Different types of kernels <span class="math inline">\(K()\)</span> are defined in the package, see <code>Kernel</code> function.</p>
<p>Example: three examples of non-parametric smoothing with different values of the bandwidth parameter (<span class="math inline">\(h = 1\)</span>, left; <span class="math inline">\(h = 10\)</span>, center and <span class="math inline">\(h\)</span> selected by the GCV criteria, right).</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="definition.html#cb24-1" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">S.NW</span>(temp<span class="sc">$</span>argvals,<span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb24-2"><a href="definition.html#cb24-2" tabindex="-1"></a>temp <span class="ot">&lt;-</span> aemet<span class="sc">$</span>temp</span>
<span id="cb24-3"><a href="definition.html#cb24-3" tabindex="-1"></a>temp.hat <span class="ot">&lt;-</span> temp</span>
<span id="cb24-4"><a href="definition.html#cb24-4" tabindex="-1"></a>temp.hat<span class="sc">$</span>data <span class="ot">&lt;-</span> temp<span class="sc">$</span>data<span class="sc">%*%</span>S</span>
<span id="cb24-5"><a href="definition.html#cb24-5" tabindex="-1"></a><span class="fu">args</span>(optim.np)</span></code></pre></div>
<pre><code>## function (fdataobj, h = NULL, W = NULL, Ker = Ker.norm, type.CV = GCV.S, 
##     type.S = S.NW, par.CV = list(trim = 0, draw = FALSE), par.S = list(), 
##     correl = TRUE, verbose = FALSE, ...) 
## NULL</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="definition.html#cb26-1" tabindex="-1"></a><span class="co"># Another way </span></span>
<span id="cb26-2"><a href="definition.html#cb26-2" tabindex="-1"></a>temp.est <span class="ot">&lt;-</span> <span class="fu">optim.np</span>(temp,<span class="at">h=</span><span class="dv">1</span>)<span class="sc">$</span>fdata.est</span>
<span id="cb26-3"><a href="definition.html#cb26-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb26-4"><a href="definition.html#cb26-4" tabindex="-1"></a><span class="fu">plot</span>(temp.est,<span class="at">main=</span><span class="st">&quot;Kernel smooth - h=1&quot;</span>)</span>
<span id="cb26-5"><a href="definition.html#cb26-5" tabindex="-1"></a>temp.est <span class="sc">==</span> temp.hat</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="definition.html#cb28-1" tabindex="-1"></a><span class="fu">plot</span>(temp.hat, <span class="at">main=</span><span class="st">&quot;Kernel smooth - h=10&quot;</span>)</span>
<span id="cb28-2"><a href="definition.html#cb28-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">optim.np</span>(temp)<span class="sc">$</span>fdata.est, <span class="at">main=</span><span class="st">&quot;Kernel smooth- h-GCV&quot;</span>)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-19-1.png" width="80%" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Finite representation in a Data-driven basis <span class="citation">(<a href="#ref-Cardot_1999">Cardot, Ferraty, and Sarda 1999</a>)</span></li>
</ol>
<ul>
<li>Functional Principal Components (FPC)
Functional Principal Components Analysis (FPCA) and the Functional PLS (FPLS) allow display the functional in a few components.</li>
</ul>
<p>The functional data can be rewritten as a decomposition in an orthonormal PC basis: maximizing the variance of <span class="math inline">\(X(t)\)</span>:</p>
<p><span class="math display">\[
\hat{X}_{i}(t)=\sum_{i=1}^{K}f_{ik}\xi_{k}(t)
\]</span></p>
<p>where <span class="math inline">\(f_{i,k}\)</span> is the score of the principal component PC, <span class="math inline">\(\xi_k\)</span>.</p>
<p>Example: Functional principal component analysis (FPCA)</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="definition.html#cb29-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(aemet<span class="sc">$</span>logprec<span class="sc">$</span>data)</span>
<span id="cb29-2"><a href="definition.html#cb29-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb29-3"><a href="definition.html#cb29-3" tabindex="-1"></a><span class="fu">plot</span>(aemet<span class="sc">$</span>temp)</span>
<span id="cb29-4"><a href="definition.html#cb29-4" tabindex="-1"></a><span class="fu">plot</span>((pc <span class="ot">&lt;-</span> <span class="fu">create.pc.basis</span>(aemet<span class="sc">$</span>temp,<span class="at">l=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>))[[<span class="st">&quot;fdata.est&quot;</span>]],</span>
<span id="cb29-5"><a href="definition.html#cb29-5" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Temperature, 2 FPC&quot;</span>)</span>
<span id="cb29-6"><a href="definition.html#cb29-6" tabindex="-1"></a>pc2 <span class="ot">&lt;-</span> <span class="fu">fdata2pc</span>(aemet<span class="sc">$</span>temp)</span>
<span id="cb29-7"><a href="definition.html#cb29-7" tabindex="-1"></a><span class="fu">plot</span>(pc2<span class="sc">$</span>rotation, <span class="at">main=</span><span class="st">&quot;2 FPC basis&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;day&quot;</span>)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-20-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="definition.html#cb30-1" tabindex="-1"></a><span class="fu">summary</span>(pc2)</span></code></pre></div>
<pre><code>## [1] TRUE
## 
##      - SUMMARY:   fdata2pc  object   -
## 
## -With 2  components are explained  98.78 %
##  of the variability of explicative variables.
##  
## -Variability for each component (%):
## [1] 85.57 13.21</code></pre>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-20-2.png" width="80%" style="display: block; margin: auto;" /></p>
<ul>
<li>Functional Partial Least Squares (FPLS) <span class="citation">(<a href="#ref-kramer">Krämer and Sugiyama 2011</a>)</span>
The PLS components seek to maximize the covariance of <span class="math inline">\(X(t)\)</span> and <span class="math inline">\(y\)</span>.</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="definition.html#cb32-1" tabindex="-1"></a><span class="fu">args</span>(create.pls.basis)</span>
<span id="cb32-2"><a href="definition.html#cb32-2" tabindex="-1"></a><span class="fu">args</span>(fdata2pls)</span></code></pre></div>
<p>An integrated version of these functions is coming.</p>
<blockquote>
<p>Example: Exploratory analysis for spectrometric curves</p>
</blockquote>
<p>Tecator dataset: 215 spectrometric curves of meat samples also with Fat, Water and Protein contents obtained by analytic procedures.</p>
<p>Tecator Goal: Explain the fat content through spectrometric curves.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="definition.html#cb33-1" tabindex="-1"></a><span class="fu">data</span>(tecator)</span>
<span id="cb33-2"><a href="definition.html#cb33-2" tabindex="-1"></a><span class="fu">names</span>(tecator)</span></code></pre></div>
<pre><code>## [1] &quot;absorp.fdata&quot; &quot;y&quot;</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="definition.html#cb35-1" tabindex="-1"></a><span class="fu">names</span>(tecator<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>## [1] &quot;Fat&quot;     &quot;Water&quot;   &quot;Protein&quot;</code></pre>
<p>As shown in tecator Figure, the plot of <span class="math inline">\(X(t)\)</span> against <span class="math inline">\(t\)</span> is not necessarily the most informative and other semi-metric can allow to extract much information from functional variables.</p>
<p>The information about fat seems to be contained in the shape of the curves, so, the semimetric of derivatives could be preferred to <span class="math inline">\(\mathcal{L}_2\)</span>. It is difficult to find the best plot given a particular functional dataset because the shape of graphics depends strongly on the proximity measure.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="definition.html#cb37-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> tecator<span class="sc">$</span>absorp</span>
<span id="cb37-2"><a href="definition.html#cb37-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb37-3"><a href="definition.html#cb37-3" tabindex="-1"></a><span class="fu">boxplot</span>(tecator<span class="sc">$</span>y<span class="sc">$</span>Fat)</span>
<span id="cb37-4"><a href="definition.html#cb37-4" tabindex="-1"></a>ycat <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tecator<span class="sc">$</span>y<span class="sc">$</span>Fat <span class="sc">&lt;</span> <span class="dv">20</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb37-5"><a href="definition.html#cb37-5" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span>ycat)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-23-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div id="derivatives" class="section level3 hasAnchor" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Derivatives<a href="definition.html#derivatives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To compute derivatives there are several options (see <code>fdata.deriv</code> function):</p>
<ul>
<li>Raw Diferentiation: Only interesting when the number of discretization points are dense.</li>
<li>Basis representation: Dierentiate a finite representation in a basis.</li>
<li>Spline Interpolation: Perform a spline interpolation of given data points and use this interpolation for computing derivatives.</li>
<li>Nonparametric Estimation: Use a Local Polynomial Estimator of the functional data.</li>
</ul>
<p>Example:</p>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-25-1.png" width="80%" style="display: block; margin: auto;" />
### Computing distances, norms and inner products</p>
<p>Utilities for computing distances, norm and inner products are included in the package. Below are described those but of course, many others can be built with the only restriction that the first two arguments correspond to class –fdata–. In addition, the procedures of the package <strong>fda.usc</strong> that contains the argument –metric– allow the use of metric or semi-metric functions as shown in the following sections.</p>
<ul>
<li>Distance between functional elements, <code>metric.lp</code>: <span class="math inline">\(d(X(t),Y(t))=\left\|X(t)-Y(t)\right\|\)</span> with a norm <span class="math inline">\(\left\| \cdot \right\|\)</span></li>
<li>Norm <code>norm.fdata</code>:
<span class="math inline">\(\left\|X(t)\right\|=\sqrt{\left\langle X(t),X(t)\right\rangle}\)</span></li>
<li>Inner product <code>inprod.fdata</code>:
<span class="math inline">\(\left\langle x,y \right\rangle=(1/4)(\left\|x+y\right\|^2-\left\|x-y\right\|^2)\)</span>.</li>
</ul>
<p>fda.usc package collects several metric and semi-metric functions which allow to extract as much information possible from the functional variable.</p>
<p>Option 1: If the data is in a Hilbert space, represent your data in a basis, and compute all the things accordingly. From a practical point of way, the representation of a functional datum
must be approximated by a finite number of terms.</p>
<ul>
<li><code>semimetric.basis()</code></li>
</ul>
<p>Option 2: Approximates all quantities using numerical approximations (Valid for Hilbert and non-Hilbert spaces). This usually involves numerical approximations of integrals, derivatives and so on. A collection of semi-metrics proposed by <span class="citation">(<a href="#ref-FV2006">Frédéric Ferraty and Vieu 2006</a>)</span> are also included in the package.</p>
<ul>
<li><code>semimetric.pca()</code>, based on the Principal Components.</li>
<li><code>semimetric.mplsr()</code>, based on the Partial Least Squares.<br />
</li>
<li><code>semimetric.deriv()</code>, based on B-spline representation.</li>
<li><code>semimetric.hshift()</code>, measure the horizontal shift effect.</li>
<li><code>semimetric.fourier()</code>, based on ther Fourier representation</li>
</ul>
<blockquote>
<p>Example of computing norms</p>
</blockquote>
<p>Consider <span class="math inline">\(X(t) = t^2; t\in[0, 1]\)</span>. In this case <span class="math inline">\(||X_1|| =\sqrt{1/5}=0.4472136\)</span> and <span class="math inline">\(||X_2|| =1/3\)</span></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="definition.html#cb38-1" tabindex="-1"></a>t <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">len =</span> <span class="dv">101</span>)</span>
<span id="cb38-2"><a href="definition.html#cb38-2" tabindex="-1"></a>x2 <span class="ot">=</span> t<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb38-3"><a href="definition.html#cb38-3" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">fdata</span>(x2, t)</span>
<span id="cb38-4"><a href="definition.html#cb38-4" tabindex="-1"></a>(<span class="fu">c</span>(<span class="fu">norm.fdata</span>(x2), <span class="fu">norm.fdata</span>(x2, <span class="at">lp =</span> <span class="dv">1</span>))) <span class="co"># L2, L1 norm</span></span></code></pre></div>
<pre><code>## [1] 0.4472509 0.3333500</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="definition.html#cb40-1" tabindex="-1"></a>f1 <span class="ot">=</span> <span class="fu">fdata</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(t)), t)</span>
<span id="cb40-2"><a href="definition.html#cb40-2" tabindex="-1"></a>f2 <span class="ot">=</span> <span class="fu">fdata</span>(<span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> t), t) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb40-3"><a href="definition.html#cb40-3" tabindex="-1"></a>f3 <span class="ot">=</span> <span class="fu">fdata</span>(<span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> t), t) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb40-4"><a href="definition.html#cb40-4" tabindex="-1"></a>f4 <span class="ot">=</span> <span class="fu">fdata</span>(<span class="fu">sin</span>(<span class="dv">4</span> <span class="sc">*</span> pi <span class="sc">*</span> t), t) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb40-5"><a href="definition.html#cb40-5" tabindex="-1"></a>f5 <span class="ot">=</span> <span class="fu">fdata</span>(<span class="fu">cos</span>(<span class="dv">4</span> <span class="sc">*</span> pi <span class="sc">*</span> t), t) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb40-6"><a href="definition.html#cb40-6" tabindex="-1"></a>fou5 <span class="ot">=</span> <span class="fu">c</span>(f1, f2, f3, f4, f5) <span class="co"># Fourier basis is Orthonormal</span></span>
<span id="cb40-7"><a href="definition.html#cb40-7" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">inprod.fdata</span>(fou5), <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0    0    0    0
## [2,]    0    1    0    0    0
## [3,]    0    0    1    0    0
## [4,]    0    0    0    1    0
## [5,]    0    0    0    0    1</code></pre>
<blockquote>
<p>Example of computing distances</p>
</blockquote>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="definition.html#cb42-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb42-2"><a href="definition.html#cb42-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1001</span></span>
<span id="cb42-3"><a href="definition.html#cb42-3" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(p,<span class="at">sd=</span>.<span class="dv">1</span>)</span>
<span id="cb42-4"><a href="definition.html#cb42-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">length=</span>p)</span>
<span id="cb42-5"><a href="definition.html#cb42-5" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">fdata</span>((<span class="fu">sin</span>(x)<span class="sc">+</span>r)<span class="sc">/</span><span class="fu">sqrt</span>(pi),x)</span>
<span id="cb42-6"><a href="definition.html#cb42-6" tabindex="-1"></a>fx0 <span class="ot">&lt;-</span> <span class="fu">fdata</span>(r,x)</span>
<span id="cb42-7"><a href="definition.html#cb42-7" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(fx,fx0))</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-27-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="definition.html#cb43-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">metric.lp</span>(fx,fx0)[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 1.003</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="definition.html#cb45-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">semimetric.basis</span>(fx,fx0,<span class="at">nbasis1=</span><span class="dv">5</span>,<span class="at">nbasis2=</span><span class="dv">5</span>)[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.993</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="definition.html#cb47-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">semimetric.basis</span>(fx,fx0,<span class="at">nbasis1=</span><span class="dv">11</span>,<span class="at">nbasis2=</span><span class="dv">111</span>)[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.999</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="definition.html#cb49-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">semimetric.fourier</span>(fx,fx0,<span class="at">nbasis=</span><span class="dv">5</span>)[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.997</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="definition.html#cb51-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">semimetric.fourier</span>(fx,fx0,<span class="at">nbasis=</span><span class="dv">11</span>)[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.999</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="definition.html#cb53-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">semimetric.deriv</span>(fx,fx0,<span class="at">nderiv=</span><span class="dv">0</span>,<span class="at">nknot=</span><span class="dv">5</span>)[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.993</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="definition.html#cb55-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">semimetric.deriv</span>(fx,fx0,<span class="at">nderiv=</span><span class="dv">0</span>,<span class="at">nknot=</span><span class="dv">11</span>)[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.998</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="definition.html#cb57-1" tabindex="-1"></a><span class="fu">integrate</span>(<span class="cf">function</span>(x){(<span class="fu">sin</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(pi))<span class="sc">^</span><span class="dv">2</span>},<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi)</span></code></pre></div>
<pre><code>## 1 with absolute error &lt; 7.3e-10</code></pre>
<blockquote>
<p>Example of semi-metric as classification rule</p>
</blockquote>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="definition.html#cb59-1" tabindex="-1"></a><span class="fu">data</span>(tecator)</span>
<span id="cb59-2"><a href="definition.html#cb59-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb59-3"><a href="definition.html#cb59-3" tabindex="-1"></a><span class="co">#ind &lt;- sample(215,30)</span></span>
<span id="cb59-4"><a href="definition.html#cb59-4" tabindex="-1"></a><span class="co">#xx &lt;- tecator$absorp[ind]</span></span>
<span id="cb59-5"><a href="definition.html#cb59-5" tabindex="-1"></a></span>
<span id="cb59-6"><a href="definition.html#cb59-6" tabindex="-1"></a>yy <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tecator<span class="sc">$</span>y<span class="sc">$</span>Fat<span class="sc">&lt;</span><span class="dv">17</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb59-7"><a href="definition.html#cb59-7" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sample</span>(<span class="fu">which</span>(yy<span class="sc">==</span><span class="dv">0</span>),<span class="dv">10</span>),<span class="fu">sample</span>(<span class="fu">which</span>(yy<span class="sc">==</span><span class="dv">1</span>),<span class="dv">10</span>))</span>
<span id="cb59-8"><a href="definition.html#cb59-8" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">fdata.deriv</span>(tecator<span class="sc">$</span>absorp[ind])</span>
<span id="cb59-9"><a href="definition.html#cb59-9" tabindex="-1"></a>yy <span class="ot">&lt;-</span> yy[ind]</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="definition.html#cb60-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb60-2"><a href="definition.html#cb60-2" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="fu">metric.lp</span>(xx),T,T)</span>
<span id="cb60-3"><a href="definition.html#cb60-3" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d1)</span>
<span id="cb60-4"><a href="definition.html#cb60-4" tabindex="-1"></a>c1<span class="sc">$</span>labels<span class="ot">=</span>yy</span>
<span id="cb60-5"><a href="definition.html#cb60-5" tabindex="-1"></a><span class="fu">plot</span>(c1,<span class="at">main=</span><span class="st">&quot;Raw data -- metric.lp&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Class of eah leaf&quot;</span>)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-29-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Try with the derivative of the curves:</p>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-30-1.png" width="80%" style="display: block; margin: auto;" /></p>
<pre><code>##    
## yy   1  2
##   0 10  0
##   1  8  2</code></pre>
<pre><code>##    
## yy   1  2
##   0 10  0
##   1  6  4</code></pre>
<p>Now the <code>fhclust()</code> function from the <code>fda.clust</code> package allows the user to do this easily. The call would be</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="definition.html#cb63-1" tabindex="-1"></a><span class="fu">fhclust</span>(xx)</span></code></pre></div>
<p>See <a href="https://moviedo5.github.io/fda.clust/reference/fhclust.html"><strong>help</strong></a> for more details.</p>
<p><strong>Extension: Multivariate Functional Data</strong></p>
<p>To combine the information of multiple components, a <span class="math inline">\(p\)</span>-dimensional metric can be used. A common choice is the Euclidean metric, defined as:</p>
<p><span class="math display">\[
m\left(\left(x_0^1, \ldots, x_0^p\right), \left(x_i^1, \ldots, x_i^p\right)\right) := \sqrt{m_1\left(x_0^1, x_i^1\right)^2 + \cdots + m_p\left(x_0^p, x_i^p\right)^2}
\]</span></p>
<p>where <span class="math inline">\(m_{i}\)</span> represents the metric corresponding to the <span class="math inline">\(i\)</span>-th component of the product space. For implementation details, see the <code>fda.usc:::metric.ldata</code> function.</p>
<p>It is essential to ensure that the metrics for the individual components have similar scales to prevent one component from disproportionately influencing the overall distance.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="definition.html#cb64-1" tabindex="-1"></a><span class="co"># Checking the range of two components to assess scale differences</span></span>
<span id="cb64-2"><a href="definition.html#cb64-2" tabindex="-1"></a><span class="fu">range</span>(d1)</span></code></pre></div>
<pre><code>## [1] 0.005531143 0.091797359</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="definition.html#cb66-1" tabindex="-1"></a><span class="fu">range</span>(d2)</span></code></pre></div>
<pre><code>## [1] 0.0003143458 0.0105466510</code></pre>
<p>Now the <code>mfhclust()</code> function from the <code>fda.clust</code> package allows the user to do this easily. The call would be:</p>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-33-1.png" width="80%" style="display: block; margin: auto;" /></p>
<pre><code>##    
## yy   1  2
##   0 10  0
##   1  8  2</code></pre>
<pre><code>##    
## yy   1  2
##   0 10  0
##   1  6  4</code></pre>
<pre><code>##    
## yy   1  2
##   0 10  0
##   1  5  5</code></pre>
<p>And an example with real data for the weather in Spain:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="definition.html#cb71-1" tabindex="-1"></a><span class="fu">data</span>(aemet, <span class="at">package =</span> <span class="st">&quot;fda.usc&quot;</span>)</span>
<span id="cb71-2"><a href="definition.html#cb71-2" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">mfdata</span>(<span class="st">&quot;temp&quot;</span><span class="ot">=</span>aemet<span class="sc">$</span>temp,<span class="st">&quot;logprec&quot;</span><span class="ot">=</span>aemet<span class="sc">$</span>logprec)</span>
<span id="cb71-3"><a href="definition.html#cb71-3" tabindex="-1"></a><span class="co"># dd = metric.mfdata(datos)</span></span>
<span id="cb71-4"><a href="definition.html#cb71-4" tabindex="-1"></a><span class="co"># Perform hierarchical clustering using the default method (ward.D2)</span></span>
<span id="cb71-5"><a href="definition.html#cb71-5" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">mfhclust</span>(datos, <span class="at">method =</span> <span class="st">&quot;ward.D2&quot;</span>)</span>
<span id="cb71-6"><a href="definition.html#cb71-6" tabindex="-1"></a><span class="co"># Plot the dendrogram</span></span>
<span id="cb71-7"><a href="definition.html#cb71-7" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">main =</span> <span class="st">&quot;Dendrogram of Multivariate Functional Data (Ward&#39;s Method)&quot;</span>)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-34-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="definition.html#cb72-1" tabindex="-1"></a><span class="co"># Cut the dendrogram into  clusters</span></span>
<span id="cb72-2"><a href="definition.html#cb72-2" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">cutree</span>(result, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb72-3"><a href="definition.html#cb72-3" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>),</span>
<span id="cb72-4"><a href="definition.html#cb72-4" tabindex="-1"></a>            <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>), </span>
<span id="cb72-5"><a href="definition.html#cb72-5" tabindex="-1"></a>            <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>)) </span>
<span id="cb72-6"><a href="definition.html#cb72-6" tabindex="-1"></a></span>
<span id="cb72-7"><a href="definition.html#cb72-7" tabindex="-1"></a>gcolors <span class="ot">&lt;-</span> colors[groups]</span>
<span id="cb72-8"><a href="definition.html#cb72-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb72-9"><a href="definition.html#cb72-9" tabindex="-1"></a><span class="fu">plot</span>(aemet<span class="sc">$</span>temp,<span class="at">col=</span>gcolors )</span>
<span id="cb72-10"><a href="definition.html#cb72-10" tabindex="-1"></a><span class="fu">plot</span>(aemet<span class="sc">$</span>logprec,<span class="at">col=</span>gcolors )</span>
<span id="cb72-11"><a href="definition.html#cb72-11" tabindex="-1"></a><span class="fu">plot</span>(aemet<span class="sc">$</span>df[<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>],<span class="at">col=</span>gcolors ,<span class="at">asp=</span>T)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-34-2.png" width="80%" style="display: block; margin: auto;" />
See <a href="https://moviedo5.gmithub.io/fda.clust/articles/MultivariateSpanishWeather.html"><strong>Example of multivariate FDA usingh Spanish Weather</strong></a> to view a use case.</p>
<blockquote>
<p>NOTE: Dependent data in tecator dataset?</p>
</blockquote>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="definition.html#cb73-1" tabindex="-1"></a><span class="co"># acf(tecator$y$Fat)</span></span>
<span id="cb73-2"><a href="definition.html#cb73-2" tabindex="-1"></a><span class="fu">ar</span>(tecator<span class="sc">$</span>y<span class="sc">$</span>Fat)</span></code></pre></div>
<pre><code>## 
## Call:
## ar(x = tecator$y$Fat)
## 
## Coefficients:
##      1       2  
## 0.6552  0.1161  
## 
## Order selected 2  sigma^2 estimated as  72.82</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="definition.html#cb75-1" tabindex="-1"></a><span class="co"># plot(tecator$y,col=1:3)</span></span>
<span id="cb75-2"><a href="definition.html#cb75-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb75-3"><a href="definition.html#cb75-3" tabindex="-1"></a><span class="co"># ts.plot(tecator$y$Fat)</span></span>
<span id="cb75-4"><a href="definition.html#cb75-4" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">t</span>(tecator<span class="sc">$</span>y))</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-35-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="correlation-distances-szekely2007" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Correlation Distances <span class="citation">(<a href="#ref-Szekely2007">G. J. Székely, Rizzo, and Bakirov 2007</a>)</span><a href="definition.html#correlation-distances-szekely2007" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The correlation Distances characterizes independence between vectors of arbitrary finite dimensions. Recently, in <span class="citation">(<a href="#ref-Szekely2013">Gábor J. Székely and Rizzo 2013</a>)</span>, a bias-corrected version is considered and a test of independence developed.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="definition.html#cb76-1" tabindex="-1"></a><span class="fu">data</span>(tecator)</span>
<span id="cb76-2"><a href="definition.html#cb76-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> tecator<span class="sc">$</span>absorp</span>
<span id="cb76-3"><a href="definition.html#cb76-3" tabindex="-1"></a>xx.d2 <span class="ot">&lt;-</span> <span class="fu">fdata.deriv</span>(xx,<span class="at">nderiv=</span><span class="dv">2</span>)</span>
<span id="cb76-4"><a href="definition.html#cb76-4" tabindex="-1"></a><span class="fu">dcor.xy</span>(xx,xx.d2)</span></code></pre></div>
<pre><code>## 
##  dcor t-test of independence
## 
## data:  D1 and D2
## T = 35.933, df = 22789, p-value &lt; 2.2e-16
## sample estimates:
## Bias corrected dcor 
##           0.2315581</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="definition.html#cb78-1" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">metric.lp</span>(xx)</span>
<span id="cb78-2"><a href="definition.html#cb78-2" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">metric.lp</span>(xx.d2)</span>
<span id="cb78-3"><a href="definition.html#cb78-3" tabindex="-1"></a><span class="fu">bcdcor.dist</span>(d1,d2)</span></code></pre></div>
<pre><code>## [1] 0.2315581</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="definition.html#cb80-1" tabindex="-1"></a>Fat <span class="ot">&lt;-</span> tecator<span class="sc">$</span>y[,<span class="st">&quot;Fat&quot;</span>,drop<span class="ot">=</span><span class="cn">FALSE</span>]</span>
<span id="cb80-2"><a href="definition.html#cb80-2" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> <span class="fu">metric.dist</span>(Fat)</span>
<span id="cb80-3"><a href="definition.html#cb80-3" tabindex="-1"></a><span class="fu">bcdcor.dist</span>(d1,d3)</span></code></pre></div>
<pre><code>## [1] 0.1963254</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="definition.html#cb82-1" tabindex="-1"></a><span class="fu">bcdcor.dist</span>(d2,d3)</span></code></pre></div>
<pre><code>## [1] 0.9147076</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="definition.html#cb84-1" tabindex="-1"></a><span class="co"># Functional / Factor</span></span>
<span id="cb84-2"><a href="definition.html#cb84-2" tabindex="-1"></a>Fat.cut <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">cut</span>(Fat[,<span class="dv">1</span>],<span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">breaks=</span><span class="dv">4</span>))</span>
<span id="cb84-3"><a href="definition.html#cb84-3" tabindex="-1"></a><span class="fu">dcor.xy</span>(Fat.cut,xx.d2)</span></code></pre></div>
<pre><code>## 
##  dcor t-test of independence
## 
## data:  D1 and D2
## T = 252.57, df = 22789, p-value &lt; 2.2e-16
## sample estimates:
## Bias corrected dcor 
##           0.8583661</code></pre>
<div id="depth-for-functional-data" class="section level3 hasAnchor" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> Depth for functional data<a href="definition.html#depth-for-functional-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Depth (in univariate or multivariate context) is a statistical tool that provides a center-outward ordering of data points. This ordering can be employed to define location measures (and by oposition outliers). Also, some measures can be defined as maximizers of a particular depth.</p>
<ul>
<li>Mahalanobis Depth (Mean) <code>mdepth.MhD</code></li>
<li>Halfspace Depth, also known as Tukey Depth (Median) <code>mdepth.HS</code></li>
<li>Convex Hull Peeling Depth (Mode)</li>
<li>Oja Depth</li>
<li>Simplicial Depth <code>mdepth.SD</code></li>
<li>Likelihood Depth (Mode) <code>mdepth.LD</code></li>
</ul>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="definition.html#cb86-1" tabindex="-1"></a>y12 <span class="ot">&lt;-</span> tecator<span class="sc">$</span>y[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb86-2"><a href="definition.html#cb86-2" tabindex="-1"></a>dep <span class="ot">&lt;-</span> <span class="fu">mdepth.LD</span>(<span class="at">x=</span>y12,<span class="at">scale=</span>T)<span class="sc">$</span>dep</span>
<span id="cb86-3"><a href="definition.html#cb86-3" tabindex="-1"></a><span class="fu">plot</span>(y12,<span class="at">col=</span><span class="fu">grey</span>(<span class="dv">1</span><span class="sc">-</span>dep))</span>
<span id="cb86-4"><a href="definition.html#cb86-4" tabindex="-1"></a><span class="fu">points</span>(y12[<span class="fu">which.max</span>(dep),],<span class="at">col=</span><span class="dv">4</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-37-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Many of the preceding depth functions defined in a multivariate contex cannot be applied to functional data. In any case, given a depth for functional data.</p>
<ul>
<li><p>The deepest point is a location measure and based on the depth function can have a dierent interpretation: Mean, Median, Mode …</p></li>
<li><p>Computing the depths of the whole sample and ordering them (in decreasing order) gives a rank from the most central point (<span class="math inline">\(x_{[1]}\)</span>) to the most outlying one (<span class="math inline">\(x_{[n]}\)</span>). So, those points with larger rank are the candidates to be outliers w.r.t. the data cloud (in the sense of the depth function).</p></li>
<li><p>Summarizing the <span class="math inline">\((1-\alpha)\)</span> deepest points could lead also to a robust location measure.</p></li>
<li><p>Fraiman-Muniz Depth <span class="citation">(<a href="#ref-FM2001">Fraiman and Muniz 2001</a>)</span> <code>depth.FM</code></p></li>
<li><p>Modal Depth <span class="citation">(<a href="#ref-Cuevas2007">Cuevas, Febrero, and Fraiman 2007</a>)</span> <code>depth.mode</code></p></li>
<li><p>Random Projection Depth <span class="citation">(<a href="#ref-Cuevas2007">Cuevas, Febrero, and Fraiman 2007</a>)</span> <code>depth.RP</code></p></li>
<li><p>Random Tukey Depth <span class="citation">(<a href="#ref-Cuesta2008">J. Cuesta-Albertos and Nieto-Reyes 2008</a>)</span> <code>depth.RT</code><br />
</p></li>
<li><p>Band Depth <span class="citation">(<a href="#ref-Lopez2009">López-Pintado and Romo 2009</a>)</span> <code>depth.MBD</code> (private function)</p></li>
</ul>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="definition.html#cb87-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> tecator<span class="sc">$</span>absorp</span>
<span id="cb87-2"><a href="definition.html#cb87-2" tabindex="-1"></a><span class="fu">depth.mode</span>(x,<span class="at">draw=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-38-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="depth-and-distances-for-multivariate-functional-data-cuesta2017hbox" class="section level3 hasAnchor" number="1.4.2">
<h3><span class="header-section-number">1.4.2</span> Depth (and distances) for multivariate functional data <span class="citation">(<a href="#ref-cuesta2017hbox">J. A. Cuesta-Albertos, Febrero-Bande, and Oviedo de la Fuente 2017</a>)</span><a href="definition.html#depth-and-distances-for-multivariate-functional-data-cuesta2017hbox" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Modify the procedure to incorporate the extended information.</p>
<ul>
<li>Fraiman–Muniz: Compute a multivariate depth marginally. <code>depth.FMp</code></li>
<li>Modal depth: Use a new distance between data (for derivatives, for example, the Sobolev metric). <code>depth.FMp</code></li>
<li>Random Projection: Consider a multivariate depth to be applied to the dierent projections (also the random projection method could be applied twice). <code>depth.RPp</code></li>
</ul>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="definition.html#cb88-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> tecator<span class="sc">$</span>absorp</span>
<span id="cb88-2"><a href="definition.html#cb88-2" tabindex="-1"></a>x.d1 <span class="ot">&lt;-</span> <span class="fu">fdata.deriv</span>(x)</span>
<span id="cb88-3"><a href="definition.html#cb88-3" tabindex="-1"></a><span class="fu">depth.modep</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">x.d1=</span>x.d1),<span class="at">draw=</span>T)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-39-1.png" width="80%" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Example poblenou dataset</p>
</blockquote>
<p>Hourly levels of nitrogen oxides in Poblenou (Barcelona). This dataset has 127 daily records (2005/01/06-2005/06/26).</p>
<p>Objective: Explain the diferences in NOx levels as a function of day.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="definition.html#cb89-1" tabindex="-1"></a><span class="fu">data</span>(poblenou)</span>
<span id="cb89-2"><a href="definition.html#cb89-2" tabindex="-1"></a>dayw <span class="ot">=</span> <span class="fu">ifelse</span>(poblenou<span class="sc">$</span>df<span class="sc">$</span>day.week <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> poblenou<span class="sc">$</span>df<span class="sc">$</span>day.festive <span class="sc">==</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="fu">ifelse</span>(poblenou<span class="sc">$</span>df<span class="sc">$</span>day.week <span class="sc">==</span> <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb89-3"><a href="definition.html#cb89-3" tabindex="-1"></a><span class="fu">plot</span>(poblenou<span class="sc">$</span>nox,<span class="at">col=</span>dayw)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-40-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The <span class="math inline">\(\mathcal{L}_2\)</span> space (distance is area between curves) seems appropriate although other possibilities could be take into account (<span class="math inline">\(\mathcal{L}_1\)</span>, for example).</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="definition.html#cb90-1" tabindex="-1"></a>fmd <span class="ot">=</span> <span class="fu">depth.FM</span>(poblenou<span class="sc">$</span>nox,<span class="at">draw=</span>T)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-41-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="definition.html#cb91-1" tabindex="-1"></a>md <span class="ot">=</span>  <span class="fu">depth.mode</span>(poblenou<span class="sc">$</span>nox)</span>
<span id="cb91-2"><a href="definition.html#cb91-2" tabindex="-1"></a>rpd <span class="ot">=</span> <span class="fu">depth.RP</span>(poblenou<span class="sc">$</span>nox, <span class="at">nproj =</span> <span class="dv">50</span>)</span>
<span id="cb91-3"><a href="definition.html#cb91-3" tabindex="-1"></a>rtd <span class="ot">=</span> <span class="fu">depth.RT</span>(poblenou<span class="sc">$</span>nox)</span>
<span id="cb91-4"><a href="definition.html#cb91-4" tabindex="-1"></a><span class="fu">print</span>(cur <span class="ot">&lt;-</span> <span class="fu">c</span>(fmd<span class="sc">$</span>lmed, md<span class="sc">$</span>lmed, rpd<span class="sc">$</span>lmed, rtd<span class="sc">$</span>lmed))</span></code></pre></div>
<pre><code>## 2005-05-06 2005-05-06 2005-05-06 2005-03-04 
##         63         63         63         10</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="definition.html#cb93-1" tabindex="-1"></a><span class="fu">plot</span>(poblenou<span class="sc">$</span>nox,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb93-2"><a href="definition.html#cb93-2" tabindex="-1"></a><span class="fu">lines</span>(poblenou<span class="sc">$</span>nox[cur], <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb93-3"><a href="definition.html#cb93-3" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;FMD&quot;</span>, <span class="st">&quot;MD&quot;</span>, <span class="st">&quot;RPD&quot;</span>, <span class="st">&quot;RTD&quot;</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-41-2.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="outliers-detection" class="section level3 hasAnchor" number="1.4.3">
<h3><span class="header-section-number">1.4.3</span> Outliers detection<a href="definition.html#outliers-detection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is no general accepted definition of outliers in Functional data so, we define outlier as a datum generated from a dierent process than the rest of the sample with the following characteristics
Its number in the sample is unknown but probably low.</p>
<p>An outlier will have low depth and it will be an outlier in the sense of the depth used.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="definition.html#cb94-1" tabindex="-1"></a>md1 <span class="ot">=</span> <span class="fu">depth.mode</span>(lab <span class="ot">&lt;-</span> poblenou<span class="sc">$</span>nox[dayw <span class="sc">==</span> <span class="dv">1</span>]) <span class="co">#Labour days</span></span>
<span id="cb94-2"><a href="definition.html#cb94-2" tabindex="-1"></a>md2 <span class="ot">=</span> <span class="fu">depth.mode</span>(sat <span class="ot">&lt;-</span> poblenou<span class="sc">$</span>nox[dayw <span class="sc">==</span> <span class="dv">2</span>]) <span class="co">#Saturdays</span></span>
<span id="cb94-3"><a href="definition.html#cb94-3" tabindex="-1"></a>md3 <span class="ot">=</span> <span class="fu">depth.mode</span>(sun <span class="ot">&lt;-</span> poblenou<span class="sc">$</span>nox[dayw <span class="sc">==</span> <span class="dv">3</span>]) <span class="co">#Sundays/Festive</span></span>
<span id="cb94-4"><a href="definition.html#cb94-4" tabindex="-1"></a><span class="fu">rbind</span>(poblenou<span class="sc">$</span>df[dayw <span class="sc">==</span> <span class="dv">1</span>, ][<span class="fu">which.min</span>(md1<span class="sc">$</span>dep), ], poblenou<span class="sc">$</span>df[dayw <span class="sc">==</span></span>
<span id="cb94-5"><a href="definition.html#cb94-5" tabindex="-1"></a><span class="dv">2</span>, ][<span class="fu">which.min</span>(md2<span class="sc">$</span>dep), ], poblenou<span class="sc">$</span>df[dayw <span class="sc">==</span> <span class="dv">3</span>, ][<span class="fu">which.min</span>(md3<span class="sc">$</span>dep),])</span></code></pre></div>
<pre><code>##          date day.week day.festive
## 22 2005-03-18        5           0
## 57 2005-04-30        6           0
## 58 2005-05-01        7           0</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="definition.html#cb96-1" tabindex="-1"></a><span class="fu">plot</span>(poblenou<span class="sc">$</span>nox,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb96-2"><a href="definition.html#cb96-2" tabindex="-1"></a><span class="fu">lines</span>(poblenou<span class="sc">$</span>nox[<span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">57</span>,<span class="dv">58</span>),], <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="bookdown_intro_files/figure-html/unnamed-chunk-42-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="definition.html#cb97-1" tabindex="-1"></a><span class="co"># Method for detecting outliers, see Febrero-Bande, 2008</span></span>
<span id="cb97-2"><a href="definition.html#cb97-2" tabindex="-1"></a><span class="co">#out1 &lt;- outliers.depth.trim(poblenou$nox[dayw == 1],nb=100)$outliers</span></span></code></pre></div>
<p>Two procedures for detecting outliers are implemented in the package. <span class="citation">(<a href="#ref-Febrero2008">Febrero-Bande, Galeano, and González-Manteiga 2008</a>)</span></p>
<ul>
<li><p>Detecting outliers based on trimming: <code>outliers.depth.trim()</code></p></li>
<li><p>Detecting outliers based on weighting: <code>outliers.depth.pond()</code></p></li>
</ul>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="definition.html#cb98-1" tabindex="-1"></a><span class="co"># Method for detecting outliers, see Febrero-Bande, 2008</span></span>
<span id="cb98-2"><a href="definition.html#cb98-2" tabindex="-1"></a><span class="co">#out1 &lt;- outliers.depth.trim(poblenou$nox[dayw == 1],nb=100)$outliers</span></span>
<span id="cb98-3"><a href="definition.html#cb98-3" tabindex="-1"></a><span class="co">#out2 &lt;- outliers.depth.pond(poblenou$nox[dayw == 1],nb=100)$outliers</span></span></code></pre></div>
</div>
</div>
<div id="references" class="section level2 unnumbered hasAnchor">
<h2>References<a href="definition.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Cardot_1999" class="csl-entry">
Cardot, Hervé, Frédéric Ferraty, and Pascal Sarda. 1999. <span>“Functional Linear Model.”</span> <em>Statist. Probab. Lett.</em> 45 (1): 11–22.
</div>
<div id="ref-cuesta2017hbox" class="csl-entry">
Cuesta-Albertos, Juan A, Manuel Febrero-Bande, and Manuel Oviedo de la Fuente. 2017. <em>Test</em> 26 (1): 119–42.
</div>
<div id="ref-Cuesta2008" class="csl-entry">
Cuesta-Albertos, Juan, and Alicia Nieto-Reyes. 2008. <span>“The Random Tukey Depth.”</span> <em>Computational Statistics and Data Analysis</em> 52 (11): 4979–88.
</div>
<div id="ref-Cuevas2007" class="csl-entry">
Cuevas, Antonio, Manuel Febrero, and Ricardo Fraiman. 2007. <span>“Robust Estimation and Classification for Functional Data via Projection-Based Depth Notions.”</span> <em>Comput. Statist.</em> 22 (3): 481–96. <a href="http://link.springer.com/article/10.1007/s00180-007-0053-0">http://link.springer.com/article/10.1007/s00180-007-0053-0</a>.
</div>
<div id="ref-Febrero2008" class="csl-entry">
Febrero-Bande, Manuel, Pedro Galeano, and Wenceslao González-Manteiga. 2008. <span>“Outlier Detection in Functional Data by Depth Measures, with Application to Identify Abnormal <span><span class="math inline">\({\rm NO}_x\)</span></span> Levels.”</span> <em>Environmetrics</em> 19 (4): 331–45.
</div>
<div id="ref-FV2006" class="csl-entry">
———. 2006. <em>Nonparametric Functional Data Analysis</em>. Springer Series in Statistics. New York: Springer-Verlag.
</div>
<div id="ref-FM2001" class="csl-entry">
Fraiman, Ricardo, and Graciela Muniz. 2001. <span>“Trimmed Means for Functional Data.”</span> <em>Test</em> 10 (2): 419–40.
</div>
<div id="ref-kramer" class="csl-entry">
Krämer, Nicole, and Masashi Sugiyama. 2011. <span>“The Degrees of Freedom of Partial Least Squares Regression.”</span> <em>Journal of the American Statistical Association</em> 106 (494): 697–705.
</div>
<div id="ref-Lopez2009" class="csl-entry">
López-Pintado, Satan, and Juan Romo. 2009. <span>“On the Concept of Depth for Functional Data.”</span> <em>Journal of the American Statistical Association</em> 104: 718–34.
</div>
<div id="ref-mu2008functional" class="csl-entry">
Muller, Hans-Georg et al. 2008. <span>“Functional Modeling of Longitudinal Data.”</span> In <em>Longitudinal Data Analysis</em>, 237–66. Chapman; Hall/CRC.
</div>
<div id="ref-Ramsay2005" class="csl-entry">
Ramsay, J. O., and B. W. Silverman. 2005a. <em>Functional Data Analysis</em>. Springer.
</div>
<div id="ref-Szekely2007" class="csl-entry">
Székely, G. J., M. L. Rizzo, and N. K. Bakirov. 2007. <span>“Measuring and Testing Dependence by Correlation of Distances.”</span> <em>The Annals of Statistics</em> 35 (6): 2769–94. <a href="http://projecteuclid.org/euclid.aos/1201012979">http://projecteuclid.org/euclid.aos/1201012979</a>.
</div>
<div id="ref-Szekely2013" class="csl-entry">
Székely, Gábor J, and Maria L Rizzo. 2013. <span>“The Distance Correlation <span class="math inline">\(t\)</span>-Test of Independence in High Dimension.”</span> <em>J. Multivariate Anal.</em> 117: 193–213.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/moviedo5/bookdown_fda_usc/edit/master/01-intro_fda_usc.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown_intro.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
